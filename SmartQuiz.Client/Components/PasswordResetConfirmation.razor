@inject NavigationManager Navigation

<MudDialog>
    <DialogContent>
        <div style="padding: 24px 0;">
            <!-- Email Icon with Blue Background -->
            <div class="d-flex justify-center mb-6">
                <div style="background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%); border-radius: 50%; padding: 20px; display: inline-flex; box-shadow: 0 4px 12px rgba(33, 150, 243, 0.2);">
                    <MudIcon Icon="@Icons.Material.Filled.MarkEmailRead" Style="color: #2196F3; font-size: 48px;"/>
                </div>
            </div>

            <!-- Title -->
            <MudText Typo="Typo.h5" Style="font-weight: 700; color: #212121; text-align: center; margin-bottom: 16px;">
                Check your email
            </MudText>

            <!-- Description -->
            <MudText Typo="Typo.body1"
                     Style="color: #424242; text-align: center; margin-bottom: 4px; line-height: 1.6;">
                We've sent password reset instructions to
            </MudText>

            <MudText Typo="Typo.body1"
                     Style="color: #212121; text-align: center; margin-bottom: 16px; font-weight: 600;">
                @Email
            </MudText>

            <MudText Typo="Typo.body2"
                     Style="color: #757575; text-align: center; margin-bottom: 28px; font-size: 14px;">
                If you don't see it soon, please check your spam folder.
            </MudText>

            <!-- Back to Login Button -->
            <MudButton
                    Variant="Variant.Filled"
                    Color="Color.Primary"
                    FullWidth
                    Size="Size.Large"
                    Style="border-radius: 8px; text-transform: none; font-weight: 600; padding: 12px; background-color: #2196F3; margin-bottom: 16px; box-shadow: 0 2px 8px rgba(33, 150, 243, 0.3);"
                    OnClick="@HandleBackToLogin">
                Back to Login
            </MudButton>

            <!-- Resend Link -->
            <div class="d-flex justify-center align-center gap-1" style="margin-bottom: 24px;">
                <MudIcon Icon="@Icons.Material.Filled.Refresh" Size="Size.Small" Style="color: #2196F3;"/>
                <MudButton
                        Variant="Variant.Text"
                        Style="text-transform: none; color: #2196F3; font-size: 14px; font-weight: 500; padding: 4px 8px;"
                        OnClick="@HandleResend"
                        Disabled="@_isResending">
                    @(_isResending ? "Sending..." : "Didn't receive the email? Click to resend")
                </MudButton>
            </div>

            <!-- Footer Divider -->
            <MudDivider Style="margin: 24px 0;"/>

            <!-- Help Footer -->
            <div class="text-center">
                <MudText Typo="Typo.body2" Style="color: #757575; font-size: 14px; display: inline;">
                    Need help?
                </MudText>
                <MudButton
                        Variant="Variant.Text"
                        Style="text-transform: none; color: #2196F3; font-size: 14px; font-weight: 500; padding: 0 4px; min-width: auto;"
                        OnClick="@HandleContactSupport">
                    Contact Support
                </MudButton>
            </div>

            <!-- Footer Copyright -->
            <MudText Typo="Typo.caption" Style="color: #9E9E9E; text-align: center; margin-top: 32px; font-size: 12px;">
                Â© 2026 QuizMaster Inc. All rights reserved.
            </MudText>
        </div>
    </DialogContent>
</MudDialog>

@code {
    [CascadingParameter] IMudDialogInstance MudDialog { get; set; } = null!;

    [Parameter] public string Email { get; set; } = string.Empty;
    [Parameter] public EventCallback OnResend { get; set; }

    private bool _isResending;

    private void HandleBackToLogin()
    {
        MudDialog.Close(DialogResult.Ok(true));
    }

    private async Task HandleResend()
    {
        _isResending = true;
        StateHasChanged();

        await Task.Delay(1500);

        if (OnResend.HasDelegate)
        {
            await OnResend.InvokeAsync();
        }

        _isResending = false;
        StateHasChanged();
    }

    private void HandleContactSupport()
    {
        // Navigate to support page or open email client
        Navigation.NavigateTo("/support", forceLoad: true);
    }

}

